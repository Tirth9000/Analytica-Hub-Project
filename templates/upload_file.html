<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Upload Datasets</title>
  <link rel="stylesheet" href="/static/upload_file.css">
</head>
<body>
  <div class="container">
    <!-- Page Title -->
    <div class="header">
      <h1>Upload Your Datasets</h1>
    </div>

    <!-- File Upload Section -->
    <div class="file-upload-container">
      <!-- File Upload Input -->
      <div class="file-card upload-card" onclick="triggerFileUpload()">
        <input type="file" id="file-input" multiple style="display: none;" accept=".csv, .xlsx">
        <div class="upload-icon-container">
          <p class="upload-text">+</p>
          <p class="add-file">Add Files</p>
        </div>
      </div>

      <!-- Placeholder for Uploaded Files -->
      <div id="file-list" class="file-list">
        <!-- Uploaded files will appear here -->
      </div>
    </div>
  </div>

  <script>
    const fileInput = document.getElementById('file-input');
    const fileList = document.getElementById('file-list');

    function triggerFileUpload() {
      fileInput.click();
    }

    fileInput.addEventListener('change', (event) => {
      const files = event.target.files;

      for (const file of files) {
        const fileCard = document.createElement('div');
        fileCard.classList.add('file-card', 'uploaded-file');

        // Create a blurred preview section
        const previewSection = document.createElement('div');
        previewSection.classList.add('file-preview');
        previewSection.textContent = "Preview Loading...";

        // Display first few rows from CSV or Excel files
        const reader = new FileReader();
        reader.onload = function (e) {
          const content = e.target.result.split('\n').slice(0, 5).join('\n');
          previewSection.textContent = content;
        };
        reader.readAsText(file);

        // Append the preview to the file card
        fileCard.appendChild(previewSection);

        // Append the file name input below the entire file card (outside the card)
        const fileNameInput = document.createElement('input');
        fileNameInput.classList.add('file-name');
        fileNameInput.value = file.name.split('.').slice(0, -1).join('.'); // Default value: file name without extension
        fileNameInput.setAttribute('type', 'text');
        
        // Append file name input below the file card
        const fileNameSection = document.createElement('div');
        fileNameSection.classList.add('file-name-section');
        fileNameSection.appendChild(fileNameInput);
        fileCard.appendChild(fileNameSection);

        // Append the file card to the file list
        fileList.appendChild(fileCard);
      }
    });
  </script>
</body>
</html>